<script src="~/js/paciente.js"></script>

<script>

    $(document).ready(function () { 
        carregarMascaras();
    });
    function AbrirModalParaCadastro() {

        AbrirModal('@Url.Action("Create", "Paciente")', 'formularioPaciente', 'modalPaciente',true)
    }

    function AbrirFormulariEdicao(id) {

        AbrirModal('@Url.Action("Edit", "Paciente")', 'formularioPaciente', 'modalPaciente',true, id)
    }

    function cadastrarPaciente() {

        let dados = $("#formularioCadastrarPaciente").serialize();
        let pacienteId = $('input[ident-paciente ="pacienteId"]').val();
        let url = pacienteId > 0 ? '@Url.Action("Edit", "Paciente")' : '@Url.Action("Create", "Paciente")';
       
        CadastrarEdiarPaciente(url, 'Conteudo', 'modalPaciente',pacienteId)

    }


    function filtrarPacientes() {
        const filterElement = document.querySelector('#txtPesquisaPaciente')
        const pacientes = document.querySelectorAll('#listaDepacientes tr')

        if (filterElement.value != '') {
            for (let paciente of pacientes) {

                let title = paciente.querySelector('td')
                title = title.textContent.toLocaleLowerCase()

                let filerText = filterElement.value.toLocaleLowerCase()
                console.log(filerText)
                if (!title.includes(filerText)) {
                    paciente.style.display = "none"
                } else {
                    paciente.style.display = "block"
                }
            }
        } else {

            for (let paciente of pacientes) {
                paciente.style.display = "block"
            }
        }
    }

    function AbrirListaDeAquivosModal_OnClick(Id) {

        AbrirModal('@Url.Action("ListarArquivosPaciente", "Paciente")', 'pnlModalArquivo', 'modalArquivo', false, Id)
    }

    function AbrirForularioArquivoModal_OnClick(pacienteId, objetoId=null) {
        AbrirFormularioCadastroEdicao('@Url.Action("CadastrarEditarArquivo", "Paciente")', pacienteId, 'pnlModalArquivo', objetoId)
    }
    
    function CadastrarEditarArquivo_OnClick() { 
        //UploadJs()
        UploadJs('@Url.Action("CadastrarEditarArquivo", "Paciente")', 'CadastrarEditarArquivo', 'pnlModalArquivo')
        //CadastrarEditarDados('@Url.Action("CadastrarEditarArquivo", "Paciente")', 'CadastrarEditarArquivo', 'pnlModalArquivo', 'txtArquivoId', 'Aqruivo cadastrado com sucesso.', 'Arquivo editado com sucesso.')
    }
    function DownloadArquivo_OnClick(id) {
        GetRequest('@Url.Action("Download", "Paciente")', id, 'Download efetuado com sucesso.');
    }

    function LimparFiltro_OnClick() {
        $(txtPesquisarPaciente).val("");
        filtrarPacientes();
    }
    function DetalhesPaciente_OnClick(url) {
        Detalhes(url, 'pnlDetalhesPaciente');
        $("#pnlBlocoObservacao").hide();
        console.log("Teste")
    }
</script>